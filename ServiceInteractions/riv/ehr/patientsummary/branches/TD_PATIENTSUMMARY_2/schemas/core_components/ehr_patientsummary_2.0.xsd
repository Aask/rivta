<?xml version="1.0" encoding="UTF-8"?>
<!-- 
 Licensed to the Apache Software Foundation (ASF) under one
 or more contributor license agreements. See the NOTICE file
 distributed with this work for additional information
 regarding copyright ownership. Sveriges Kommuner och Landsting licenses this file
 to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance
 with the License. You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing,
 software distributed under the License is distributed on an
 "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 KIND, either express or implied. See the License for the
 specific language governing permissions and limitations
 under the License.
 -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:tns="urn:riv:ehr:patientsummary:2" targetNamespace="urn:riv:ehr:patientsummary:2" elementFormDefault="qualified" attributeFormDefault="unqualified" version="2.0">
	<xs:import schemaLocation="datatypes.xsd"/>
	<xs:complexType name="AssignedEntityType">
		<xs:annotation>
			<xs:documentation>
				Information om person som signerat dokument
			
				assignedEntityID: 
					HSA-id för person
				representedOrganizationID: 
					HSA-id för den organisation som personen har uppdrag för
			</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="assignedEntityID" type="tns:HSAIdType"/>
			<xs:element name="representedOrganizationID" type="tns:HSAIdType" minOccurs="0"/>
			<xs:any namespace="##other" processContents="lax" minOccurs="0" maxOccurs="unbounded"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="AuthorizationType">
		<xs:annotation>
			<xs:documentation>
				Information om menprövning
			
				authorizationCode: 
					Kod för typ av menprövning. Värden från kodverket KV XX
			</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="authorizationCode" type="tns:AuthorizationCodeType"/>
			<xs:any namespace="##other" processContents="lax" minOccurs="0" maxOccurs="unbounded"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="AuthorType">
		<xs:annotation>
			<xs:documentation>
				Information om författare till dokumentet
			
				authorTime: 
					Information om författare till dokumentet
				authorID: 
					HSA-id för författare. 
					OID för HSA används (1.2.752.129.2.2.1.4)
				authorRoleCode: 
					Kod för författarens befattning, enligt kodverket Befattning (OID 1.2.752.129.2.2.1.4)
				authorName: 
					Namn på författaren
				authorOrganizationID: 
					HSA-id för den enhet som författaren är uppdragstagare hos
				authorOrganizationName: 
					Namn på den enhet som författaren är uppdragstagare hos
				authorOrganizationTelecom: 
					Telefonnummer till den enhet som författaren är uppdragstage hos
				authorOrganizationAddress: 
					Adress till den enhet som författaren är uppdragstagere hos
				careProviderId:
					HSA-id för vårdgivaren, som är vårdgivare för den enhet som författaren är uppdragstagare för
			</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="authorTime" type="TS"/>
			<xs:element name="authorID" type="tns:AuthorIdType"/>
			<xs:element name="authorRoleCode" type="tns:AuthorRoleCodeType"/>
			<xs:element name="authorName" type="ST" minOccurs="0"/>
			<xs:element name="authorOrganizationID" type="tns:HSAIdType"/>
			<xs:element name="authorOrganizationName" type="ST" minOccurs="0"/>
			<xs:element name="authorOrganizationTelecom" type="ST" minOccurs="0"/>
			<xs:element name="authorOrganizationAddress" type="ST" minOccurs="0"/>
			<xs:element name="careProviderID" type="tns:HSAIdType"/>
			<xs:any namespace="##other" processContents="lax" minOccurs="0" maxOccurs="unbounded"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="CareDocumentationType">
		<xs:sequence>
			<xs:element name="clinicalDocumentNote" type="tns:ClinicalDocumentNoteType"/>
			<xs:element name="multimediaEntry" type="tns:MultimediaEntryType" minOccurs="0" maxOccurs="unbounded"/>
			<xs:any namespace="##other" processContents="lax" minOccurs="0" maxOccurs="unbounded"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="ClinicalDocumentNoteType">
		<xs:annotation>
			<xs:documentation>
			Dokument/anteckning
			
			careDocumentNoteCode: 
				Typ av vård- och omsorgsdokument. 
				Kod tas från KV Anteckningstyp (1.2.752.129.2.2.2.11).
				Tillåtna värden från kodverk	Anteckningstyp: 
					utr = Utredning, 
					atb = åtgärd/Behandling, 
					sam = Sammanfattning, 
					sao = Samordning, 
					ins = Inskrivning, 
					slu = Slutanteckning, 
					auf = Anteckning utan fysiskt
			careDocumentNoteTitle: 
				Titel på dokument
			careDocumentNoteText: 
				Själva dokumentet. 
				Formatet i textfältet ska följa HL7 CDA "Narrative Block". 
				Om dokumentet innehåller multimedia läggs en platshållare i texten enligt formatet <renderMultiMedia referencedObject="MM1"/>. 
				Innehåller dokumentet fler multimedia läggs ytterligare platshållare i texten, där referencesObject får namn "MM2", "MM3" osv
		</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="careDocumentNoteCode" type="tns:CareDocumentNoteCodeType"/>
			<xs:element name="careDocumentNoteTitle" type="ST" minOccurs="0"/>
			<xs:element name="careDocumentNoteText" type="ST"/>
			<xs:any namespace="##other" processContents="lax" minOccurs="0" maxOccurs="unbounded"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="CustodianType">
		<xs:annotation>
			<xs:documentation>
				Information om PDL-enhet som har ansvar för informationen
			
				custodianID: 
					HSA-id för PDL-enhet
			</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="custodianID" type="tns:HSAIdType"/>
			<xs:any namespace="##other" processContents="lax" minOccurs="0" maxOccurs="unbounded"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="EncompassingEncounterType">
		<xs:annotation>
			<xs:documentation>
				Information om  Vård- och omsorgskontakt som föranlett vårddokumentation.
			
				encounterID: 
					Unik identifierare för vård- och omsorgskontakt. 
					OID kan sättas till 1.2.752.129.2.1.2.1  (Icke-nationell identifierare Org+lokalt unikt id)
				encounterTime: 
					Tidpunkt för vård- och omsorgskontakt
			</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="encounterID" type="II"/>
			<xs:element name="encounterTime" type="TS"/>
			<xs:any namespace="##other" processContents="lax" minOccurs="0" maxOccurs="unbounded"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="HeaderType">
		<xs:annotation>
			<xs:documentation>
				careDocumentID: 
					Vårddokumentets unika identifierare.
					OID kan sättas till 1.2.752.129.2.1.2.1 (Icke-nationell identifierare Org+lokalt unikt id)
				careDocumentTitle: 
					Titel på dokument
				careDocumentTime: 
					Tidpunkt då dokumentet skapades
				patientID: 
					Patientens ID. Root sätts till typ av patientsidentifierare.  
					Bland tillåtna typer finns: 
						personnummer (1.2.752.129.2.1.3.1), 
						samordningsnummer (1.2.752.129.2.1.3.3), 
						reservnummer SLL (1.2.752.97.3.1.3)
			</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="careDocumentID" type="tns:CareDocumentIdType"/>
			<xs:element name="careDocumentTitle" type="ST" minOccurs="0"/>
			<xs:element name="careDocumentTime" type="TS"/>
			<xs:element name="patientID" type="tns:PatientIdType"/>
			<xs:element name="author" type="tns:AuthorType"/>
			<xs:element name="custodian" type="tns:CustodianType"/>
			<xs:element name="legalAuthenticator" type="tns:LegalAuthenticatorType" minOccurs="0"/>
			<xs:element name="authorization" type="tns:AuthorizationType" minOccurs="0"/>
			<xs:element name="encompassingEncounter" type="tns:EncompassingEncounterType" minOccurs="0"/>
			<xs:any namespace="##other" processContents="lax" minOccurs="0" maxOccurs="unbounded"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="LegalAuthenticatorType">
		<xs:annotation>
			<xs:documentation>
				Information om signering
			
				signatureTime: 
					Tidpunkt för signering, format YYYYMMDDHHMMSS. 
					RIV: Vård- och omsorgsdokument.signeringstidpunkt
			</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="signatureTime" type="tns:TimeStampType"/>
			<xs:element name="assignedEntity" type="tns:AssignedEntityType" minOccurs="0"/>
			<xs:any namespace="##other" processContents="lax" minOccurs="0" maxOccurs="unbounded"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="MultimediaEntryType">
		<xs:annotation>
			<xs:documentation>
				Multimedia som finns i dokumentet, motsvaras av platshållare i careDocumentNoteText
			
				multiMediaID: 
					ID på multimedia
				value: 
					Multimediainnehållet, med lämplig mime-typ och kodningstyp
			</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="multiMediaID" type="ST"/>
			<xs:element name="value" type="ED"/>
			<xs:any namespace="##other" processContents="lax" minOccurs="0" maxOccurs="unbounded"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="ResultType">
		<xs:annotation>
			<xs:documentation>
				Vid ett logiskt fel i de uppdaterande tjänsterna levereras resultCode, resultText. 
				resultCode kan vara:
			
				OK
					Transaktionen har utförts enligt uppdraget i frågemeddelandet.
				INFO
					Transaktionen har utförts enligt begäran, men det finns ett meddelande
					som konsumenten måste visa upp för användaren (om tillämpbart).
					Exempel på detta kan vara ”kom fastande”.
				ERROR
					Transaktionen har INTE kunnat utföras enligt p.g.a. logiskt fel. 
					Det finns ett meddelande som konsumenten måste visa upp. 
					Exempel på detta kan vara ”tiden har bokats av annan patient
			</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="resultCode" type="tns:ResultCodeEnum"/>
			<xs:element name="resultText" type="ST" minOccurs="0"/>
		</xs:sequence>
	</xs:complexType>
	<!-- Below: types that extends another type and adds some restriction to the type  -->
	<xs:complexType name="AuthorIdType">
		<xs:complexContent>
			<xs:restriction base="II">
				<xs:attribute name="root" use="required" fixed="1.2.752.129.2.2.1.4">
					<xs:simpleType>
						<xs:restriction base="uid"/>
					</xs:simpleType>
				</xs:attribute>
			</xs:restriction>
		</xs:complexContent>
	</xs:complexType>
	<xs:complexType name="AuthorizationCodeType">
		<xs:complexContent>
			<xs:restriction base="II">
				<xs:attribute name="root" type="uid" use="required"/>
			</xs:restriction>
		</xs:complexContent>
	</xs:complexType>
	<xs:complexType name="AuthorRoleCodeType">
		<xs:complexContent>
			<xs:restriction base="II">
				<xs:attribute name="root" use="required" fixed="1.2.752.129.2.2.1.4">
					<xs:simpleType>
						<xs:restriction base="uid"/>
					</xs:simpleType>
				</xs:attribute>
			</xs:restriction>
		</xs:complexContent>
	</xs:complexType>
	<xs:complexType name="CareDocumentIdType">
		<xs:complexContent>
			<xs:restriction base="II">
				<xs:attribute name="root" type="uid" use="required"/>
			</xs:restriction>
		</xs:complexContent>
	</xs:complexType>
	<xs:complexType name="CareDocumentNoteCodeType">
		<xs:complexContent>
			<xs:restriction base="CD">
				<xs:attribute name="code" use="required">
					<xs:simpleType>
						<xs:restriction base="cs">
							<xs:enumeration value="utr"/>
							<xs:enumeration value="atb"/>
							<xs:enumeration value="sam"/>
							<xs:enumeration value="sao"/>
							<xs:enumeration value="ins"/>
							<xs:enumeration value="slu"/>
							<xs:enumeration value="auf"/>
						</xs:restriction>
					</xs:simpleType>
				</xs:attribute>
				<xs:attribute name="codeSystem" use="required" fixed="1.2.752.129.2.2.2.11">
					<xs:simpleType>
						<xs:restriction base="uid"/>
					</xs:simpleType>
				</xs:attribute>
			</xs:restriction>
		</xs:complexContent>
	</xs:complexType>
	<xs:complexType name="EncounterIdType">
		<xs:complexContent>
			<xs:restriction base="II">
				<xs:attribute name="root" type="uid" use="required"/>
			</xs:restriction>
		</xs:complexContent>
	</xs:complexType>
	<xs:complexType name="HSAIdType">
		<xs:complexContent>
			<xs:restriction base="II">
				<xs:attribute name="root" use="required" fixed="1.2.752.129.2.1.4.1">
					<xs:simpleType>
						<xs:restriction base="uid"/>
					</xs:simpleType>
				</xs:attribute>
			</xs:restriction>
		</xs:complexContent>
	</xs:complexType>
	<xs:complexType name="PatientIdType">
		<xs:complexContent>
			<xs:restriction base="II">
				<xs:attribute name="root" type="uid" use="required"/>
			</xs:restriction>
		</xs:complexContent>
	</xs:complexType>
	<xs:simpleType name="ResultCodeEnum">
		<xs:restriction base="xs:string">
			<xs:enumeration value="OK"/>
			<xs:enumeration value="ERROR"/>
			<xs:enumeration value="INFO"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:complexType name="TimeStampType">
		<xs:complexContent>
			<xs:restriction base="TS">
				<xs:attribute name="value">
					<xs:simpleType>
						<xs:restriction base="ts">
							<xs:pattern value="(19|20)\d\d(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])\d{6}"/>
						</xs:restriction>
					</xs:simpleType>
				</xs:attribute>
			</xs:restriction>
		</xs:complexContent>
	</xs:complexType>
</xs:schema>
